---
# title: "Changes in self-reported mental & physical health"
# subtitle: "A time series analysis"
# author: "James Malloy & Patrice Powell"
# date: "11/16/2021"
# output:
#   powerpoint_presentation: default
# ioslides_presentation: default
# beamer_presentation: default
# slidy_presentation: default
# editor_options:
#   chunk_output_type: inline
# always_allow_html: true
---
  
```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.asp= 0.6,
  dpi = 300
)
```

class: title-slide, left, bottom

# `r rmarkdown::metadata$title`
----
## **`r rmarkdown::metadata$subtitle`**
### `r rmarkdown::metadata$author`
### `r rmarkdown::metadata$date`

---
class: inverse, middle, center

# An inverse slide

Often used for transitions

---

# A slide where bullets appear

-- 
<!-- two dashes are for incremental effects -->

* first point

--

* second point

--

* third point

--

* fourth point

---

```{r}
library(tidyverse)
library(haven)
library(broom)
library(kableExtra) # makes data frames tidy when you knit

theme_update(plot.title = element_text(hjust = 0.5)) # centers plot titles
theme_update(plot.subtitle = element_text(hjust = 0.5)) # centers subtitles

gss21 <- read_stata("gss21.dta") %>% 
  select(id, year, sex, hlthmntl, hlthphys) %>% 
  na.omit(hlthphys)

gss18 <- read_stata("gss18.dta") %>% 
  select(id, year, sex, hlthmntl, hlthphys) %>% 
  na.omit(hlthphys)

gss_merged <- rbind(gss18, gss21) %>% 
  mutate(year = as.factor(year)) %>%       # Make year be numeric
  mutate(mental_health =                   # Create new variable `mental_health`
           as.numeric(                     # Make `mental_health numeric
             ifelse(hlthmntl == 1, 5,      # Reverse code `mental_health`
                    ifelse(hlthmntl == 2, 4,
                           ifelse(hlthmntl == 3, 3,
                                  ifelse(hlthmntl == 4, 2, 
                                         ifelse(hlthmntl == 5, 1, ""
                                         ))))))) %>% 
  mutate(physical_health = 
           as.numeric(
             ifelse(hlthphys == 1, 5,
                    ifelse(hlthphys == 2, 4,
                           ifelse(hlthphys == 3, 3,
                                  ifelse(hlthphys == 4, 2, 
                                         ifelse(hlthphys == 5, 1, ""
                                         )))))))



```

# Objective

## Field of Research
- Health

## Research Question
- Do self-reported physical and mental health differ among U.S. adults in 2018 vs U.S. adults in 2021?
  
  
```{r physical-health-2018}
ggplot(health_by_year, aes(x = year, 
                           y = avg_phys_health,
                           color = physical_health,
                           group = physical_health)) +
  annotate("point", x = 2018, y = 3.335481, size = 2, color = "red") +
  xlim(2017, 2021) +
  ylim(3.25, 3.4) +
  labs(y = "Health Average", 
       title = "Physical Health Among US Adults", 
       subtitle = "2018")
```


```{r physical-health-18-21}

ggplot(health_by_year, aes(x = year, 
                           y = avg_phys_health, 
                           color = physical_health,
                           group = physical_health,
                           label = "avg_phys_health")) + # trying to add numeric labels, not working
  geom_point(size = 2, color = "red") +
  geom_line(color = "red") +
  ylim(3.25, 3.4) +
  labs(y = "Health Average", 
       title = "Physical Health Among U.S. Adults", 
       subtitle = "2018 - 2021")
```


```{r mental-health-18}
ggplot(health_by_year, aes(x = year, 
                           y = avg_phys_health,
                           color = physical_health,
                           group = physical_health,
                           label = value)) +
  annotate("point", x = 2018, y = 3.661942, size = 2, color = "blue") +
  xlim(2017, 2021) +
  ylim(3,4) +
  labs(y = "Health Average", 
       title = "Mental Health Among US Adults", 
       subtitle = "2018")
```


```{r mental-health-21}
ggplot(health_by_year, aes(x = year, 
                           y = avg_mntl_health, 
                           color = mental_health,
                           group = mental_health,
                           label = avg_mntl_health)) +
  geom_point(size = 2, color = "blue") +
  geom_line(color = "blue") +
  ylim(3, 4) +
  labs(y = "Average")
```


# Research Question
- Do self-reported physical and mental health differ among U.S. adults from 2018 to 2021?
  
```{r physical-and-mental-health-plot}

ggplot(health_by_year, aes(x = year, 
                           y = avg_mntl_health, 
                           color = mental_health,
                           group = yeargroup)) +
  annotate("point", x = 2018, y = 3.661942, size = 2, color = "blue" ) +
  annotate("point", x = 2021, y = 3.484899, size = 2, color = "blue") +
  annotate("point", x = 2018, y = 3.335481, size = 2, color = "red") +
  annotate("point", x = 2021, y = 3.327515, size = 2, color = "red") +
  annotate("segment", x = 2018, xend = 2021, y = 3.661942, yend = 3.484899, color = "blue") +
  annotate("segment", x = 2018, xend = 2021, y = 3.335481, yend = 3.327515, color = "red") +
  scale_x_discrete(labels=c("2018","2021")) +  ## trying to add 2021 to tick label, not working
  geom_vline(xintercept = 2019.5, ) +
  xlim(2016, 2023) +
  ylim(3, 4) +
  labs(y = "Health Average", 
       title = "Physical & Mental Health",
       subtitle = "2018-2021") +
  scale_fill_manual(values = "avg_mntl_health")  + # legend still not working
  scale_shape_manual(values = c(21, 24) )

```


# Methods

###### Data Source
- General Social Survey 2018 & 2021

###### Variables
- independent variable: `year` (binary, 2018 or 2021)

- dependent variable: `mental_health` (interval)
`physical_health` (interval)
###### Data cleaning
- merge
- reverse code

###### Statistical Method
- independent samples t-test
- "We needed this specific test because we wanted to evaluate whether the mean physical and mental health differed significantly across two groups (respondents in 2018 vs respondents in 2021).

###### Threshold
- $\alpha = 0.05$
- two-tailed

###### Null hypothesis
- $H_0:\mu_1 - \mu_2 = 0$

###### Alternate hypothesis: 
- $H_1:\mu_1 - \mu_2 \ne 0$


# T-test assumptions

1. Interval-level outcome

2. Independence of observations

3. Equal variance


```{r}

tidy(
  var.test(mental_health ~ year, data = gss_merged))

tidy(
  var.test(physical_health ~ year, data = gss_merged))
```




# T-test assumptions

1. Interval-level outcome

2. Independence of observations

3. Equal variance

4. No outliers

```{r dispersion}
ggplot(gss_merged, aes(mental_health)) +
  geom_bar(fill = "blue") + 
  facet_wrap(~year) +
  labs(title = "Mental Health")
```


```{r}
ggplot(gss_merged, aes(physical_health)) +
  geom_bar(fill = "red") + 
  facet_wrap(~year) +
  labs(title = "Physical Health")
```

# Findings


```{r}

tidy(t.test(mental_health ~ year, data = gss_merged)) %>% 
  datatable()

tidy(t.test(physical_health ~ year, data = gss_merged)) %>% 
  datatable()

```

# Conclusions

Conclusions drawn and any potential limitations discussed
What do your results imply for the identified field of research
Provide direction(s) for future research


# Physical Health Among U.S. Adults

```{r physical-health-18-21, echo=FALSE}

ggplot(health_by_year, aes(x = year, 
                           y = avg_phys_health, 
                           color = physical_health,
                           group = physical_health,
                           label = "avg_phys_health")) + # trying to add numeric labels, not working
  geom_point(size = 2, color = "red") +
  geom_line(color = "red") +
  ylim(3.25, 3.4) +
  labs(y = "Average") 
 
```


<!-- # What's your hypothesis? -->

<!-- .pull-left[ -->

<!-- <iframe src="https://embed.polleverywhere.com/multiple_choice_polls/LifZNdOyM4uALkp2saM4w?controls=none&short_poll=true" width="800px" height="600px"></iframe> -->

<!-- ] -->

<!-- .center[ -->

<!-- <a rel='nofollow' href='https://www.qr-code-generator.com' border='0' style='cursor:default'></a><img src='https://chart.googleapis.com/chart?cht=qr&chl=https%3A%2F%2FPollEv.com%2Fmultiple_choice_polls%2FpKo9PDBZGO6u54gSDsMzR%2Frespond&chs=180x180&choe=UTF-8&chld=L|2' alt=''> -->

<!-- ] -->

<!-- --- -->